# Feature Specification: DAG隐私计算任务编排系统

**Feature Branch**: `001-dag-task-orchestration`
**Created**: 2026-01-29
**Status**: Draft
**Input**: User description: "实现隐私计算任务编排，支持拖拽多个计算任务节点至画布，与数据源节点一起进行编排，包括数据源节点连入输入数据、配置和编排计算模型、配置计算资源、编排输出数据、将输出数据连入其他任务节点、以及接入结果处理任务等。最终完成整个DAG流程图的编排工作，可将编排结果转换并导出成一种标准的json格式，DAG流程图中各个元素都转换为json格式中的对象。"

## User Scenarios & Testing *(mandatory)*

### User Story 1 - 拖拽创建计算任务 (Priority: P1)

数据分析师需要在画布上创建隐私计算任务节点，通过拖拽方式从左侧资源面板选择计算任务类型（PSI、PIR、MPC）并放置到画布中，选择技术路径（软件密码学或硬件TEE）后开始编排计算流程。

**Why this priority**: 这是核心功能的基础，没有计算任务节点就无法构建隐私计算DAG流程。

**Independent Test**: 可以独立测试用户拖拽计算任务到画布、弹出技术路径选择窗口、成功创建计算任务节点并显示基础信息。

**Acceptance Scenarios**:

1. **Given** 用户在左侧资源面板看到"计算任务"分类，**When** 拖拽"PSI计算"到画布并释放鼠标，**Then** 弹出技术路径选择窗口（"软件密码学"或"硬件TEE"）
2. **Given** 技术路径选择窗口显示，**When** 用户选择"软件密码学"并确认，**Then** 画布上创建computeType为"PSI"的计算任务节点，技术路径锁定不可更改
3. **Given** 用户在左侧资源面板，**When** 看到"联邦学习"选项，**Then** 该选项显示为灰色不可拖拽状态（暂缓实现）
4. **Given** 画布上已有计算任务节点，**When** 节点未选中时，**Then** 节点卡片仅显示关键基础信息（任务名称、计算类型、技术路径）

---

### User Story 2 - 配置输入数据与字段映射 (Priority: P1)

当数据源节点或其他计算任务的输出节点连线到计算任务时，用户需要通过字段选择窗口配置输入数据，包括选择字段、设置join字段和连接类型、设置字段别名。

**Why this priority**: 输入数据配置是计算任务执行的前提，没有正确的输入配置无法进行计算。

**Independent Test**: 可以独立测试用户从数据源节点连线到计算任务、弹出字段选择窗口、选择字段和join条件、成功保存输入配置。

**Acceptance Scenarios**:

1. **Given** 画布上有数据源节点A（包含字段：id, name, age）和计算任务节点B，**When** 用户从数据源节点A拖拽连线到计算任务节点B，**Then** 弹出字段选择窗口，显示数据源A的所有可选字段，默认全选
2. **Given** 字段选择窗口显示，**When** 用户选择id字段为join字段并设置连接类型为"INNER"，**Then** 系统保存join条件到`joinConditionList`结构
3. **Given** 用户为name字段设置别名为"userName"，**When** 另一个数据源也有"userName"别名，**Then** 系统在别名后标*提示冲突
4. **Given** 字段选择窗口显示，**When** 用户点击取消，**Then** 连线不成功，计算任务不保存该输入源
5. **Given** 计算任务已配置输入数据，**When** 用户选中该计算任务，**Then** 右侧详情面板"输入数据"section可折叠展开，显示已配置的数据源和字段信息

---

### User Story 3 - 配置计算模型 (Priority: P2)

用户需要通过拖拽方式为计算任务添加计算模型，包括MPC模型（表达式）、MPC模型（CodeBin系列）、MPC模型（SPDZ），并在右侧详情面板中对模型参数进行编排或编辑表达式代码。

**Why this priority**: 计算模型定义了计算任务的执行逻辑，是核心配置项之一。

**Independent Test**: 可以独立测试用户拖拽计算模型到计算任务节点、在详情面板配置模型参数、保存模型配置。

**Acceptance Scenarios**:

1. **Given** 左侧资源面板有"计算模型"分类，**When** 用户拖拽"MPC模型(表达式)"到计算任务节点上并释放，**Then** 计算任务左侧新增一个已连接的计算模型子节点，详情面板"计算模型"section新增"MPC模型(表达式)"子section
2. **Given** 用户选择"MPC模型(表达式)"，**When** 在右侧详情面板查看，**Then** 显示Python代码编辑器文本框，支持输入类似"participantId.assetName.columnName"的变量引用
3. **Given** 用户在代码编辑器中输入"org"，**When** 触发变量补全，**Then** 显示所有可用的输入数据列引用建议（如"org1.bank10.id", "org2.tax10.name"）
4. **Given** 用户拖拽"MPC模型(CodeBin-V2)"到计算任务，**When** 模型连接成功，**Then** 弹出企业选择窗口，选择企业后显示该企业可用的CodeBin-V2模型列表
5. **Given** 非表达式模型已添加，**When** 用户在右侧详情面板查看模型参数，**Then** 可为每个参数选择绑定到输入数据的字段或设置固定值
6. **Given** 计算任务左侧有已连接的计算模型节点，**When** 用户删除该模型连线，**Then** 弹出确认提示，确认后从计算任务中移除该模型

---

### User Story 4 - 配置算力资源 (Priority: P2)

用户需要为计算任务配置算力资源（目前支持TEE板卡算力），通过拖拽方式添加，在右侧详情面板查看和编辑算力资源信息。

**Why this priority**: 算力资源决定了计算任务的执行环境，是TEE技术路径的必要配置。

**Independent Test**: 可以独立测试用户拖拽算力资源到计算任务节点、在详情面板查看算力配置、删除算力资源。

**Acceptance Scenarios**:

1. **Given** 左侧资源面板有"算力资源"分类，**When** 用户拖拽"TEE板卡算力"到计算任务节点上并释放，**Then** 计算任务右侧新增一个已连接的算力资源子节点
2. **Given** 算力资源拖拽到计算任务节点，**When** 释放鼠标，**Then** 弹出企业选择窗口，选择企业后显示该企业可用的TEE算力列表
3. **Given** 算力资源配置成功，**When** 用户选中计算任务节点，**Then** 右侧详情面板"算力资源"section显示已配置的算力信息（企业、节点、板卡型号）
4. **Given** 算力资源已配置，**When** 用户选中具体的算力资源节点，**Then** 右侧详情面板高亮显示该算力资源的配置section
5. **Given** 计算任务右侧有已连接的算力资源节点，**When** 用户删除该算力连线，**Then** 弹出确认提示，确认后从计算任务中移除该算力

---

### User Story 5 - 配置输出数据节点 (Priority: P1)

用户需要为计算任务添加输出数据节点，选择输出参与方企业和输出字段，输出节点可以作为其他计算任务的输入。

**Why this priority**: 输出数据是计算结果的使用方式，也是连接多个计算任务的桥梁。

**Independent Test**: 可以独立测试用户点击计算任务下方的Click-to-Connect按钮、配置输出参与方和字段、输出节点作为其他任务输入。

**Acceptance Scenarios**:

1. **Given** 画布上有计算任务节点A，**When** 用户点击计算任务下方的"添加输出"按钮，**Then** 在计算任务下方新增一个已连接的输出数据节点
2. **Given** 输出数据节点创建时，**When** 弹出输出配置窗口，**Then** 显示"选择输出参与方企业"选项（优先显示相关资源企业：数据资源所属企业、计算模型所属企业、算力所属企业），也支持选择全网其他企业
3. **Given** 用户选择输出参与方企业后，**When** 选择输出数据字段，**Then** 可选字段包括计算任务的输入字段和模型输出结果字段（MPC表达式只有一个输出）
4. **Given** 计算任务有多个输出数据节点，**When** 用户选中计算任务节点，**Then** 右侧详情面板"输出数据"section显示所有输出，支持增删操作
5. **Given** 计算任务节点被删除，**When** 关联的输出数据节点存在，**Then** 所有关联的输出数据节点自动删除
6. **Given** 有输出数据节点A属于计算任务B，**When** 用户删除输出数据节点A与计算任务B的连线，**Then** 输出数据节点A自动删除
7. **Given** 输出数据节点已配置，**When** 用户从该输出节点拖拽连线到另一个计算任务，**Then** 该输出节点的字段作为目标任务的输入选项

---

### User Story 6 - 本地结果处理任务编排 (Priority: P3)

用户需要创建本地计算任务（CONCAT类型），将多个计算任务的输出结果进行本地拼接处理，最终输出给指定参与方企业。

**Why this priority**: 本地结果处理是数据流转的终点，实现最终结果的交付。

**Independent Test**: 可以独立测试用户拖拽"本地结果处理任务"到画布、选择参与方企业、配置输入数据、导出CONCAT类型任务。

**Acceptance Scenarios**:

1. **Given** 左侧资源面板有"本地计算任务"分类，**When** 用户拖拽"本地结果处理任务"到画布并释放，**Then** 弹出参与方企业选择窗口（优先显示相关资源企业）
2. **Given** 参与方企业选择窗口显示，**When** 用户选择企业并确认，**Then** 画布上创建computeType为"CONCAT"的本地结果处理任务节点
3. **Given** 本地结果处理任务已创建，**When** 用户从其他计算任务的输出节点连线到该任务，**Then** 该输出作为本地任务的输入数据源
4. **Given** 本地结果处理任务已配置输入，**When** 系统导出JSON，**Then** 该任务的computeType为"CONCAT"，dataProviderList包含所有输入数据源
5. **Given** 左侧资源面板，**When** 用户查看"本地Query任务"，**Then** 该选项显示为灰色不可拖拽状态（下个迭代支持）

---

### User Story 7 - 导出标准JSON格式 (Priority: P1)

用户需要将编排完成的DAG流程图导出为标准JSON格式，包含所有节点、连接线、配置信息，用于提交给后端服务执行。

**Why this priority**: 导出功能是整个编排系统的最终输出，是实现业务价值的关键。

**Independent Test**: 可以独立测试用户点击导出按钮、系统转换DAG为JSON、JSON格式符合规范样例。

**Acceptance Scenarios**:

1. **Given** 用户已完成DAG流程编排，**When** 点击顶部"导出"按钮，**Then** 系统调用导出转换逻辑，生成符合样例格式的JSON文件
2. **Given** 导出JSON生成，**When** 查看JSON结构，**Then** 包含jobId、name、participantList、taskList等顶级字段
3. **Given** 计算任务节点A（PSI类型），**When** 导出JSON，**Then** taskList中包含computeType为"PSI"的任务，dataProviderList结构正确，joinConditionList包含join条件
4. **Given** 计算任务节点B（MPC表达式），**When** 导出JSON，**Then** expressionList包含Python表达式字符串
5. **Given** 计算任务配置了算力资源，**When** 导出JSON，**Then** computeProviderList包含算力节点信息
6. **Given** 计算任务配置了计算模型，**When** 导出JSON，**Then** modelProviderList包含模型参数映射信息
7. **Given** 计算任务有输出数据节点，**When** 导出JSON，**Then** resultConsumerList包含输出配置信息
8. **Given** 本地结果处理任务，**When** 导出JSON，**Then** computeType为"CONCAT"，isFinalTask为true

---

### User Story 8 - 实时预览导出JSON (Priority: P2)

用户需要在右侧详情面板实时预览导出的JSON内容，随着DAG编排的修改实时更新预览，便于及时发现问题。

**Why this priority**: 实时预览提供了即时反馈，帮助用户在编排过程中验证配置正确性。

**Independent Test**: 可以独立测试用户切换到JSON预览模式、修改DAG编排、JSON预览实时更新。

**Acceptance Scenarios**:

1. **Given** 用户选中画布上的任意节点，**When** 右侧详情面板显示，**Then** 面板顶部有切换按钮可在"节点详情"和"JSON预览"之间切换
2. **Given** 用户切换到"JSON预览"模式，**When** 查看右侧面板，**Then** 显示当前DAG导出的完整JSON内容，格式化展示
3. **Given** 用户在"JSON预览"模式下，**When** 添加新的节点或连线，**Then** JSON预览实时更新显示最新内容
4. **Given** JSON预览显示，**When** 用户修改计算任务的输入字段配置，**Then** 对应的dataProviderList字段立即更新

---

### Edge Cases

- **连线到不支持的任务类型**：当用户尝试连线到暂缓实现的"联邦学习"任务时，系统应阻止操作并提示"该类型暂未开放"
- **删除中间节点**：当用户删除DAG中间的计算任务节点时，系统应自动清理所有相关连线（输入连线、输出连线、模型连线、算力连线）和关联的输出数据节点
- **字段别名冲突**：当来自不同数据源的字段别名相同时，系统应在别名后标*提示，但不阻止操作
- **无可用企业**：当配置算力资源或计算模型时，如果选定企业没有可用资源，系统应提示"该企业暂无可用资源"
- **Join条件不完整**：当用户配置输入数据但未设置任何join字段时，系统应提示"至少选择一个join字段"
- **输出字段冲突**：当MPC表达式只有一个输出时，用户选择输出字段应自动锁定为该输出
- **循环依赖**：当用户尝试创建循环依赖（任务A输出连到任务B，任务B输出又连回任务A）时，系统应检测并阻止
- **技术路径更改**：计算任务的技术路径一经选定不可更改，用户界面应禁用修改选项
- **未配置必填项**：当任务未配置输入数据、计算模型或算力资源时，导出前应提示缺少必要配置
- **表达式语法错误**：当用户输入的Python表达式有语法错误时，代码编辑器应显示错误提示

## Requirements *(mandatory)*

### Functional Requirements

#### 左侧资源面板扩展
- **FR-001**: 系统必须在左侧资源面板与"数据源"、"计算任务"同级位置新增"计算模型"、"算力资源"、"本地计算任务"三大资源分类
- **FR-002**: 系统必须在"计算任务"分类中提供"PSI计算"、"PIR查询"、"MPC计算"三种可拖拽任务类型
- **FR-003**: 系统必须在"计算任务"分类中将"联邦学习"显示为灰色不可拖拽状态（暂缓实现）
- **FR-004**: 系统必须在"计算模型"分类中提供"MPC模型(表达式)"、"MPC模型(CodeBin-V2)"、"MPC模型(CodeBin-V3-1)"、"MPC模型(CodeBin-V3-2)"、"MPC模型(SPDZ)"五种可拖拽模型
- **FR-005**: 系统必须在"算力资源"分类中提供"TEE板卡算力"可拖拽资源
- **FR-006**: 系统必须在"本地计算任务"分类中提供"本地结果处理任务"可拖拽任务
- **FR-007**: 系统必须在"本地计算任务"分类中将"本地Query任务"显示为灰色不可拖拽状态（下个迭代支持）

#### 计算任务拖拽与创建
- **FR-008**: 系统必须在用户拖拽计算任务到画布释放时弹出技术路径选择窗口（"软件密码学"或"硬件TEE"）
- **FR-009**: 系统必须在用户选择技术路径后创建计算任务节点，根据任务类型和技术路径设置对应的computeType（PSI/TEE_PSI、PIR/TEE_PIR、MPC/TEE_MPC）
- **FR-010**: 系统必须在计算任务节点创建后锁定技术路径，不允许后续更改
- **FR-011**: 系统必须在计算任务节点左侧提供固定handle用于连接计算模型
- **FR-012**: 系统必须在计算任务节点右侧提供固定handle用于连接算力资源
- **FR-013**: 系统必须在计算任务节点下方提供"添加输出"按钮（Click-to-Connect）

#### 输入数据配置
- **FR-014**: 系统必须在用户从数据源节点或输出数据节点连线到计算任务时弹出字段选择窗口
- **FR-015**: 系统必须在字段选择窗口中显示来源节点的所有可选字段，默认全选
- **FR-016**: 系统必须要求用户至少选择一个字段，允许选择的字段中至少设置一个为join字段
- **FR-017**: 系统必须为每个join字段提供连接类型选择："INNER"（内连接）或"CROSS"（笛卡尔积连接）
- **FR-018**: 系统必须允许为每个字段设置别名，默认别名为字段名
- **FR-019**: 系统必须在检测到来自不同数据源的别名相同时，在别名后标*提示冲突
- **FR-020**: 系统必须在用户取消字段选择时阻止连线成功
- **FR-021**: 系统必须将保存的输入数据转换为`dataProviderList`结构（包含participantId、datasetList、columnNameList、columnAliasList、columnTypeList）
- **FR-022**: 系统必须将保存的join条件转换为`joinConditionList`结构（包含joinType、joinOperands）

#### 计算模型配置
- **FR-023**: 系统必须只允许用户拖拽计算模型到计算任务节点上释放，其他位置不允许释放
- **FR-024**: 系统必须在用户拖拽计算模型到计算任务释放时在任务左侧创建已连接的计算模型子节点
- **FR-025**: 系统必须在用户删除计算模型连线时弹出确认提示，确认后删除该模型配置
- **FR-026**: 系统必须在"MPC模型(表达式)"被添加时，在右侧详情面板显示Python代码编辑器文本框
- **FR-027**: 系统必须在代码编辑器中支持"participantId.assetName.columnName"格式的变量引用
- **FR-028**: 系统必须在代码编辑器编辑时提供变量自动补全功能，补全所有输入数据列的引用
- **FR-029**: 系统必须在非表达式模型被添加时，弹出企业选择窗口，选择后显示该企业的可用模型列表
- **FR-030**: 系统必须在右侧详情面板为非表达式模型提供参数配置界面，支持将参数绑定到输入数据字段或设置为固定值
- **FR-031**: 系统必须将保存的非表达式模型转换为`modelProviderList`结构（包含modelId、participantId、name、type、modelParameterList）
- **FR-032**: 系统必须将MPC表达式转换为`expressionList`结构（包含expression字符串）

#### 算力资源配置
- **FR-033**: 系统必须只允许用户拖拽算力资源到计算任务节点上释放，其他位置不允许释放
- **FR-034**: 系统必须在用户拖拽算力资源到计算任务释放时在任务右侧创建已连接的算力资源子节点
- **FR-035**: 系统必须在算力资源拖拽释放时弹出企业选择窗口，选择后显示该企业的可用算力列表
- **FR-036**: 系统必须在用户删除算力资源连线时弹出确认提示，确认后删除该算力配置
- **FR-037**: 系统必须将保存的算力资源转换为`computeProviderList`结构（包含groupId、participantId、groupName、computeNodeList、computeCardList）

#### 输出数据配置
- **FR-038**: 系统必须在用户点击"添加输出"按钮时在计算任务下方创建已连接的输出数据节点
- **FR-039**: 系统必须在输出数据节点创建时弹出配置窗口，要求选择输出参与方企业和输出数据字段
- **FR-040**: 系统必须在参与方企业选择中优先显示相关资源企业（数据资源所属企业、计算模型所属企业、算力所属企业），也支持选择全网其他企业
- **FR-041**: 系统必须在输出字段选择中提供计算任务输入字段和模型输出结果字段（MPC表达式只有一个输出）
- **FR-042**: 系统必须在右侧详情面板"输出数据"section显示所有输出，支持增删操作
- **FR-043**: 系统必须在计算任务节点被删除时自动删除所有关联的输出数据节点
- **FR-044**: 系统必须在输出数据节点与计算任务的连线被删除时自动删除该输出数据节点
- **FR-045**: 系统必须将保存的输出数据转换为`resultConsumerList`结构（包含participantId、datasetList、columnNameList、columnAliasList、columnTypeList）

#### 本地计算任务
- **FR-046**: 系统必须在用户拖拽"本地结果处理任务"到画布释放时弹出参与方企业选择窗口
- **FR-047**: 系统必须将"本地结果处理任务"的computeType设置为"CONCAT"
- **FR-048**: 系统必须允许其他计算任务的输出节点连线到本地结果处理任务作为输入

#### 导出JSON功能
- **FR-049**: 系统必须提供独立的、清晰的、隔离的导出转换逻辑模块
- **FR-050**: 系统必须将DAG流程图转换为包含jobId、name、description、participantList、taskList的JSON结构
- **FR-051**: 系统必须在taskList中为每个计算任务生成正确的computeType（PSI/TEE_PSI/PIR/TEE_PIR/MPC/TEE_MPC/CONCAT）
- **FR-052**: 系统必须将任务依赖关系（taskSrcIdList）正确导出到JSON
- **FR-053**: 系统必须生成DAG到JSON转换规则的spec文档，便于日后维护和修改

#### JSON预览功能
- **FR-054**: 系统必须在右侧详情面板提供"节点详情"和"JSON预览"切换按钮
- **FR-055**: 系统必须在"JSON预览"模式下实时显示当前DAG的导出JSON内容
- **FR-056**: 系统必须在用户修改DAG编排时实时更新JSON预览内容

#### Mock接口
- **FR-057**: 系统必须提供企业列表接口的mock数据（包含participantId、entityName）
- **FR-058**: 系统必须提供计算模型列表接口的mock数据（按type枚举值分类：CodeBin-V2、CodeBin-V3-1、CodeBin-V3-2、SPDZ）
- **FR-059**: 系统必须提供算力资源列表接口的mock数据（包含TEE板卡算力信息）
- **FR-060**: 系统必须提供数据资产字段接口的mock数据（包含 columnName、type、length、comments）

### Key Entities

#### 计算任务节点 (ComputeTaskNode)
- 表示画布上的隐私计算任务，包含任务基本信息（ID、名称、计算类型、技术路径）
- 关联输入数据列表（dataProviderList）、join条件列表（joinConditionList）
- 关联计算模型列表（modelProviderList或expressionList）
- 关联算力资源列表（computeProviderList）
- 关联输出数据节点列表（resultConsumerList）

#### 输出数据节点 (OutputDataNode)
- 从属于特定计算任务节点，生命周期依赖于父任务
- 包含输出参与方企业信息、输出字段配置
- 可作为其他计算任务的输入数据源

#### 计算模型节点 (ModelNode)
- 通过连线关联到计算任务节点
- 包含模型ID、所属企业、模型类型、参数映射配置
- 表达式类型模型包含Python代码内容

#### 算力资源节点 (ComputeResourceNode)
- 通过连线关联到计算任务节点
- 包含算力组ID、所属企业、节点地址、板卡信息

#### 本地结果处理任务 (LocalConcatTask)
- 特殊类型的计算任务，computeType固定为"CONCAT"
- 需要指定所属参与方企业
- 接收其他任务的输出作为输入，进行本地拼接

## Success Criteria *(mandatory)*

### Measurable Outcomes

- **SC-001**: 用户可以在30秒内完成从拖拽计算任务到配置好输入数据、计算模型、算力资源的完整流程
- **SC-002**: DAG编排转换导出JSON的准确率达到100%，符合所有样例格式规范
- **SC-003**: 用户可以成功编排包含5个以上计算任务的复杂DAG流程图
- **SC-004**: JSON预览实时响应时间在500ms以内，DAG修改后立即更新预览
- **SC-005**: 用户首次使用即可成功完成导出操作，无需额外培训或文档查阅
- **SC-006**: 系统支持至少20个节点的大型DAG流程图编排而不出现性能问题
- **SC-007**: 90%的用户能够在5分钟内理解并使用拖拽配置计算模型和算力资源的交互方式
- **SC-008**: 导出的JSON文件通过后端服务验证的成功率达到100%
- **SC-009**: 用户可以清晰区分三种可拖拽资源（计算模型、算力资源、本地计算任务）的用途和使用场景
- **SC-010**: 代码编辑器的变量补全功能覆盖所有输入数据列的引用，补全准确率达到95%

---

## Assumptions

1. 用户已具备基本的DAG流程图编辑器使用经验（拖拽、连线、删除操作）
2. 用户了解隐私计算的基本概念（PSI、PIR、MPC）和技术路径差异（软件密码学 vs 硬件TEE）
3. 企业、模型、算力等资源的mock数据与真实后端接口保持一致的数据结构
4. 导出的JSON格式规范由后端服务定义，前端负责按规范转换
5. 用户使用现代浏览器（Chrome、Firefox、Edge等）访问系统
6. 画布节点数量在合理范围内（不超过50个节点），避免极端性能场景
7. 表达式代码编辑器的语法高亮和补全功能基于Monaco Editor或CodeMirror实现
8. 用户理解join字段的作用（INNER vs CROSS连接类型的差异）

---

## Out of Scope

- 联邦学习任务的完整实现（仅预留位置，置灰不可拖拽）
- 本地Query任务的实现（下个迭代支持）
- 计算任务的执行、监控和结果展示（仅负责编排和导出）
- DAG流程图的版本控制和历史记录
- 多用户协同编辑同一个DAG流程图
- DAG流程图的自动保存和恢复
- 计算任务的调试和单步执行
- 复杂的表达式语法校验和错误提示（仅提供基础编辑器功能）
- 输出数据字段的加密配置（导出JSON中包含加密字段配置，但UI暂不实现加密设置）

---

## Dependencies

### External Dependencies
- 后端服务接口：企业列表、计算模型列表、算力资源列表、数据资产字段（本功能使用mock数据）
- 代码编辑器库：Monaco Editor或CodeMirror（用于表达式编辑）

### Internal Dependencies
- 现有的DAG画布组件（FlowCanvas.vue）
- 现有的节点拖拽系统
- 现有的连接线管理系统

---

## Notes

- 导出JSON转换逻辑必须独立实现，与UI组件解耦，便于后续维护和测试
- 所有涉及企业、模型、算力的选择都需要mock接口支持，不依赖后端服务
- 节点详情面板需要支持多个可折叠section的展开/收起状态管理
- 输出数据节点虽然在视觉上是独立节点，但在数据模型上从属于父计算任务节点
- DAG到JSON的转换规则需要生成独立的spec文档（specs/DAG_TO_JSON_SPEC.md）
