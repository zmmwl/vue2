/speckit.specify  **计算任务编排**：支持拖拽多个计算任务节点至画布，与数据源节点一起进行编排，如：由数据源节点连入输入数据、配置和编排计算模型、配置计算资源、编排输出数据、将输出数据连入其他任务节点、以及接入结果处理任务等。最终完成整个DAG流程图的编排工作，可将编排结果导出成一种标准的json格式，DAG流程图中各个元素(如：数据节点、不同的计算任务、及其输入、模型、算力、输出等)都转换为json格式中的对象，导出格式样例为`.myprompt/specs/models/dag.json`。

- **新增可拖拽资源类型**：左侧除"数据源"和"计算任务"外，新增**计算模型**、**算力资源**和**本地计算任务**三大类，配置时参考**计算任务配置资源校验规则**
  - **计算模型**：包含"MPC模型(表达式)","MPC模型(CodeBin-V2)","MPC模型(CodeBin-V3-1)","MPC模型(CodeBin-V3-2)"和"MPC模型(SPDZ)"，
    - **计算模型配置方式**：要拖拽到计算任务节点上才可释放，体现为计算任务节点左侧放置一个新的已连接的计算模型节点。一个计算任务节点可配置多个计算模型，计算任务节点左侧须新增一个固定的handle，与这些模型相连，连线删除则相应的模型应被删除(删除前需提示确认)
    - **计算模型选择方式**："MPC模型(表达式)"不需要选择，其他模型需通过选择企业->选择模型进行选择，相关接口位于`.myprompt/specs/interfaces/企业列表.md`、`.myprompt/specs/interfaces/模型目录/计算模型/获取全网计算模型.md`，根据type的枚举值`CodeBin-V2、CodeBin-V3-1、CodeBin-V3-2、SPDZ`来对应不同的模型类型。
    - **计算模型编排方式**：在计算任务节点详情面板增加"计算模型"可折叠section，每拖拽放置一个计算模型，就相应增加一个子section。当计算任务节点被选中为焦点时，详情面板"计算模型"section下全部模型都可以编排，当某个具体的"计算模型"被选中时，详情面板中只有被选模型可被编排(高亮显示)。
  - **算力资源**：目前只包含一种可拖拽算力："TEE板卡算力"
    - **算力资源配置方式**：要拖拽到计算任务节点上才可释放，体现为计算任务节点右侧放置一个新的已连接的算力资源节点。一个计算任务节点可配置多个*算力资源，计算任务节点右侧须新增一个固定的handle，与这些算力资源相连，连线删除则相应的算力资源应被删除(删除前需提示确认)
    - **算力资源选择方式**：选择企业->选择算力，相关接口位于`.myprompt/specs/interfaces/企业列表.md`、`.myprompt/specs/interfaces/算力目录/全网算力列表.md`
    - **算力资源编排方式**：算力资源选择完毕后，在计算任务节点详情面板增加"算力资源"可折叠section，每拖拽放置一个算力资源，就相应增加一个子section。当计算任务节点被选中为焦点时，详情面板"算力资源"section下全部算力资源都可以编排，当某个具体的"算力资源"被选中时，详情面板中只有被选算力资源可被编排(高亮显示)。
  - **本地计算任务**：增加"本地计算任务"菜单，包含**本地结果处理任务**、**本地Query任务**等，可由数据源节点或其他计算任务的输出数据节点连接输入
    - **本地计算任务拖拽方式**：拖拽释放到画布时必须且只能选择一个**参与方企业(participant)**，优先从当前流程全部任务的相关资源提供方列表(包括：数据资源所属企业、计算模型所属企业、算力所属企业)选取，也支持从其他全网企业中选择
    - 暂不实现**本地Query任务**，现实为灰色，下个迭代支持

- **计算任务**：拖拽计算任务到画布后，可对其**输入数据**、**计算模型**、**算力资源**、**输出数据**进行编排。计算任务节点卡片只展示基本信息，右侧节点详情除展示计算任务自身的基本信息外，还需展示输入、模型、算力、输出这些编排好的信息，并支持修改
  - **选择技术路径**：拖拽计算任务在画布中释放时，弹出窗口选择使用"软件密码学"技术路径还是"硬件TEE"技术路径。技术路径选择非常关键，且一经选定不可更改。
  - **计算任务类型**：包含**PSI计算**、**PIR查询**、**MPC计算**、**联邦学习**四种类型，每种类型的标识以及最终存储转换的格式见`.myprompt/specs/pctasks.md`
  - **配置输入数据**：当一个数据源节点或其他计算任务输出数据节点连线至计算任务时，则弹出窗口进行**字段选择**，选定后即保存为当前任务输入数据，若取消则连线不成功。
    - **字段选择**：可选字段由来源数据源节点的数据资产字段或来源计算任务节点的输出数据字段决定，至少应选择一个字段，默认选定全部字段；选择的字段中至少选定一个字段为**join字段**，并设置其类型为"INNER"(内连接) or "CROSS"(笛卡尔积连接)
    - **保存输入数据**：将一个数据来源所选好的字段，以子section的形式保存，并展示在右侧详情中"输入数据"section下方，可折叠收起
    - **别名设置**：可以为保存的每个字段设置别名(便于在计算模型编排时引用)。默认的别名为字段名，如果有来自于不同数据源的别名发生冲突(相同)，则需要标*提示
    - 计算任务支持多输入数据来源
  - **配置计算模型**：模型由左侧菜单拖拽到当前任务释放鼠标选定，保存为当前任务的一个计算模型，并在右侧节点详情中支持展示和修改，参考**计算模型配置方式**
    - **非表达式模型参数映射**：除"MPC模型(表达式)"外，其余模型均定义了参数规格，在右边详情面板可对模型的参数进行编排，即将参数与某个输入数据的字段进行绑定映射，也可支持参数为固定值
    - **MPC模型(表达式)**: 则不需要过多的选择，直接以一个代码编辑文本框的形式展示为计算模型的子section
      - 文本框中可以支持python语法，可以用"participantId.assetName.columnName"的命名方式使用所有连接进来的输入数据
      - 这个文本框在编辑的时候需要类似编程IDE，提供一定的辅助功能，比如代码变量补全，即补全刚才提到的输入数据列的引用"participantId.assetName.columnName"
  - **配置算力资源**：参考**新增可拖拽资源类型**中的**算力资源**
  - **配置输出数据**：在计算任务下方增加一个伸出的Click-to-Connect，点击后在计算任务下方新增一个连接好的特殊的"输出数据节点"，此节点与数据节点类似，只是包含的字段只能由计算任务输出
    - **输出数据字段配置**：可以直接从计算任务的输入字段选取，也可以从模型输出结果选取，"MPC模型(表达式)"只有一个输出，其余模型都定义了输出字段
    - **输出参与方企业(participantId)配置**：一个数据输出节点只能从属一个参与方，优先从当前任务的相关资源所属方列表(包括：数据资源所属企业、计算模型所属企业、算力所属企业)选取，也支持从其他全网企业中选择
- **计算任务配置资源校验规则**：向计算任务拖拽配置模型资源和计算资源时须进行校验，具体规则详见`.myprompt/specs/dragrules.md`

- **导出标准Json**:一定要仔细读`.myprompt/specs/models/dag.json`，要导出的全部节点的样例都在里面。
- **mock接口**：这是前端项目，本身不包含后端服务，与后端服务之间仅存在接口调用。之前提到的相关接口都是本项目外已实现接口，在本项目开发测试阶段要构建mock的测试桩，不要依赖后端服务。