/speckit.constitution  这是一个前端图形拖拽编排项目，用以实现隐私计算的图形化拖拽编排操作。用户可拖拽数据源、任务等元素，将其连接成DAG任务图，并详细设置每个任务的细节属性，最终生成一份标准的json格式的DAG任务图。
- 参考CLAUDE.md获得初始宪章需要的必要信息
- 这是前端项目，本身不包含后端服务，与后端服务之间存在接口调用。但是须要注意，在开发测试阶段不要依赖后端服务，要提供mock的测试桩

/speckit.specify  在拖拽一个数据源到画布释放时，需要让用户能够选择具体的数据资产，并且在选定之后，当鼠标选择了画布上的这个数据源时，可以在右侧显示其具体的数据资产信息。以上用户的编排结果要包含在导出的json中
- **选择数据资产的过程**：通过选择企业->选择数据资产->选择数据资产中的多个字段的过程确定最终数据资源
- **企业列表接口**：接口位于`.myprompt/specs/interfaces/企业列表.md`，可获取得全部企业列表，或根据企业名称过滤
- **数据资产列表接口**：接口位于`.myprompt/specs/interfaces/数据资产列表.md`, 可获取全部数据资产列表，或根据所属企业名称、资产名称等信息过滤
- **数据资产详情接口**：接口位于`.myprompt/specs/interfaces/数据资产详情.md`，确定数据资产后，可使用次列表获取数据资产全部源信息，以便根据字段进行选择
- **数据资产选择|编排**：对拖拽到画布的数据源，设计一种高效、易用、用户界面友好的的选择、编排数据资产的方式
- **任务图结果导出**：一个数据源经过选择最终对应一个确定的数据资产，编排完成后，导出整个DAG图为json的时候，数据源要包含


/speckit.specify  **计算任务编排**：支持拖拽多个计算任务节点至画布，与数据源节点一起进行编排，包括数据源节点连入输入数据、配置和编排计算模型、配置计算资源、编排输出数据、将输出数据连入其他任务节点、以及接入结果处理任务等。最终完成整个DAG流程图的编排工作，可将编排结果转换并导出成一种标准的json格式，DAG流程图中各个元素(如：数据节点、不同的计算任务、及其输入、模型、算力、输出等)都转换为json格式中的对象，**导出格式样例**为`.myprompt/specs/models/830PSI+MPC.json`(软件PSI+软件MPC)、`.myprompt/specs/models/830PSI+MPC-TEE.json`(TEEPSI+TEEMPC)、`.myprompt/specs/models/830PIR-TEE.json`(TEEPIR)和`.myprompt/specs/models/830PIR-TEE.json`(PIR)。

- **新增可拖拽资源类型**：左与"数据源"、"计算任务"等同级，新增**计算模型**、**算力资源**和**本地计算任务**三大类，在**计算任务编排**拖拽相应组件时可参考`.myprompt/specs/DAG_SPEC.md`
- **计算任务编排**：拖拽计算任务到画布后，可对其**输入数据**、**计算模型**、**算力资源**、**输出数据**进行编排，右侧节点详情面板按不同可折叠section展示这些信息并支持修改，任务卡片只展示关键基础信息。
  - **选择技术路径**：拖拽计算任务在画布中释放时，弹出窗口选择使用"软件密码学"技术路径还是"硬件TEE"技术路径，一经选定不可更改。
  - **计算任务类型**：包含**PSI计算**、**PIR查询**、**MPC计算**、**联邦学习**四种类型，每种类型的标识以及最终转换导出的格式见`.myprompt/specs/tasksrules.md`。其中联邦学习暂缓实现，可以置灰，禁止拖拽
  - **配置输入数据**：当一个数据源节点或其他计算任务输出数据节点连线至计算任务时，则弹出窗口进行**字段选择**，选定后即保存数据来源为当前任务输入数据，若取消则连线不成功。导出时参考**导出格式样例**中的`dataProviderList`结构
    - **字段选择**：可选字段由来源数据源节点的数据资产字段或来源计算任务节点的输出数据字段决定，至少应选择一个字段，默认选定全部字段；选择的字段中至少选定一个字段为**join字段**，并设置其类型为"INNER"(内连接) or "CROSS"(笛卡尔积连接)，导出时参考**导出格式样例**中的`joinConditionList`结构
    - **别名设置**：可以为保存的每个字段设置别名(便于在计算模型编排时引用)。默认的别名为字段名，如果有来自于不同数据源的别名发生冲突(相同)，则需要标*提示
  - **配置计算模型**：模型由左侧菜单拖拽到当前任务释放鼠标选定，当前任务增加一个计算模型，并在右侧节点详情中支持展示和修改
    - **拖拽配置**：参考`.myprompt/specs/DAG_SPEC.md`中的**计算模型拖拽配置**。
    - **非表达式模型参数映射**：除"MPC模型(表达式)"外，其余模型均定义了参数规格，在右边详情面板可对模型的参数进行编排，即将参数与某个输入数据的字段进行绑定映射，也可支持参数为固定值。导出时参考**导出格式样例**中的`modelProviderList`结构
    - **MPC模型(表达式)**: 则不需要过多的选择，直接以一个代码编辑文本框的形式展示为计算模型的子section，导出时参考**导出格式样例**中的`expressionList`结构
      - 文本框中可以支持python语法，可以用"participantId.assetName.columnName"的命名方式使用所有连接进来的输入数据
      - 这个文本框在编辑的时候需要类似编程IDE，提供一定的辅助功能，比如代码变量补全，即补全刚才提到的输入数据列的引用"participantId.assetName.columnName"
  - **配置算力资源**：配置时参考`.myprompt/specs/DAG_SPEC.md`中的**算力资源拖拽配置**，导出时参考**导出格式样例**中的`computeProviderList`结构
  - **配置输出数据**：在计算任务下方增加一个伸出的Click-to-Connect，点击后在计算任务下方新增一个连接好的特殊的**输出数据节点**，可以为某一个参与方企业提供计算结果输出。此节点与数据源节点类似，只是包含的字段只能由计算任务输出。导出时参考**导出格式样例**中的`resultConsumerList`结构
    - 计算节点的输出可以是多个，类似数据源节点，新增时弹窗**选择输出参与方企业**，**选择输出数据字段**，在右侧计算任务的详情面板可以对所有的输出进行增删。
    - **选择输出参与方企业**：一个数据输出节点只能从属一个参与方，优先从当前任务的相关资源所属方列表(包括：数据资源所属企业、计算模型所属企业、算力所属企业)选取，也支持从其他全网企业中选择
    - **选择输出数据字段**：可以直接从计算任务的输入字段选取，也可以从模型输出结果选取，"MPC模型(表达式)"只有一个输出，其余模型都定义了输出字段
    - **输出数据节点声明周期**：虽然是独立节点，内容和形式也类似数据源节点，但从属于计算任务节点，其内容也在计算任务节点中体现。与计算任务节点关联取消、或者计算任务节点删除时，此节点都应该自动删除。
- **结果处理任务**：配置时参考`.myprompt/specs/DAG_SPEC.md`中的**本地结果处理任务**，导出时参考**导出格式样例**中的`"computeType": "CONCAT"`的task
- **导出标准Json**:由DAG流程图转换到导出json模型的逻辑，在代码上要独立、清晰、隔离、解耦，便于日后维护和修改,另外把DAG图转换成json模型的规则，以spec的形式生成文档，以便日后更新与维护。
- **导出标准Json预览**:右侧详情面板可以切换为导出json预览，根据DAG图的编排，实时预览json导出结果
- **mock接口**：这是前端项目，本身不包含后端服务，与后端服务之间仅存在接口调用。之前提到的相关接口都是本项目外已实现接口，在本项目开发测试阶段要构建mock的测试桩，不要依赖后端服务。

ultra think
